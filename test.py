from pydantic import BaseModel, model_validator
from src.solvia_for_chat.config_manager.i18n import I18nMixin

class è§’è‰²(BaseModel):
    åå­—: str
    ç­‰çº§: int
    è¡€é‡: int
    æ­¦å™¨: str
    
    @model_validator(mode="before")  # è¿›å…¥æˆ˜æ–—å‰çš„å‡†å¤‡é˜¶æ®µ
    @classmethod
    def æˆ˜æ–—å‡†å¤‡(cls, è§’è‰²æ•°æ®):
        print("ğŸ›¡ï¸ æˆ˜æ–—å‡†å¤‡é˜¶æ®µï¼š", è§’è‰²æ•°æ®)
        # æ£€æŸ¥å¹¶å‡†å¤‡è£…å¤‡
        if isinstance(è§’è‰²æ•°æ®, dict):
            if 'æ­¦å™¨' in è§’è‰²æ•°æ® and è§’è‰²æ•°æ®['æ­¦å™¨'] == 'æœ¨å‰‘':
                è§’è‰²æ•°æ®['æ­¦å™¨'] = 'é“å‰‘'  # å‡çº§æ­¦å™¨
                print("âš”ï¸ æ­¦å™¨å‡çº§ï¼šæœ¨å‰‘ â†’ é“å‰‘")
        return è§’è‰²æ•°æ®
    
    @model_validator(mode="after")   # æˆ˜æ–—ç»“æŸåçš„æ£€æŸ¥é˜¶æ®µ
    def æˆ˜æ–—æ£€æŸ¥(self):
        print("ğŸ¯ æˆ˜æ–—æ£€æŸ¥é˜¶æ®µï¼š", self)
        # æ£€æŸ¥è§’è‰²çŠ¶æ€æ˜¯å¦åˆç†
        if self.ç­‰çº§ < 10 and self.è¡€é‡ > 1000:
            raise ValueError("âŒ ç­‰çº§å¤ªä½ï¼Œè¡€é‡ä¸å¯èƒ½è¿™ä¹ˆé«˜ï¼")
        if self.æ­¦å™¨ == 'æœ¨å‰‘' and self.ç­‰çº§ > 50:
            raise ValueError("âŒ ç­‰çº§è¿™ä¹ˆé«˜è¿˜ç”¨æœ¨å‰‘ï¼Ÿè¯¥æ¢æ­¦å™¨äº†ï¼")
        return self

# åˆ›å»ºè§’è‰²
print("=== åˆ›å»ºæ–°æ‰‹è§’è‰² ===")
æ–°æ‰‹ = è§’è‰²(åå­—="è¤ªè‰²è€…", ç­‰çº§=5, è¡€é‡=500, æ­¦å™¨="æœ¨å‰‘")

print("\n=== åˆ›å»ºé«˜çº§è§’è‰² ===")
é«˜çº§ = è§’è‰²(åå­—="è‰¾å°”ç™»ä¹‹ç‹", ç­‰çº§=60, è¡€é‡=2000, æ­¦å™¨="æœˆå…‰å¤§å‰‘")


